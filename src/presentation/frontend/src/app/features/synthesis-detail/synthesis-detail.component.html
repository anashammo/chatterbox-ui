<div class="detail-container">
  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <h3>Loading synthesis...</h3>
  </div>

  <!-- Error State -->
  <div class="error-message" *ngIf="error && !isLoading">
    <span>‚ö†Ô∏è {{ error }}</span>
    <button class="btn btn-primary" (click)="goBack()">Go Back</button>
  </div>

  <!-- Synthesis Detail -->
  <div class="synthesis-detail" *ngIf="synthesis && !isLoading">
    <!-- Header -->
    <div class="header">
      <h1>Synthesis Details</h1>
      <div class="header-actions">
        <button class="btn btn-primary" routerLink="/">New Synthesis</button>
        <button class="btn btn-secondary" routerLink="/history">View History</button>
      </div>
    </div>

    <!-- Status Card -->
    <div class="status-card">
      <div class="status-header">
        <span class="status-badge" [ngClass]="getStatusClass(synthesis.status)">
          {{ synthesis.status }}
        </span>
        <span class="model-badge" [ngClass]="'model-' + synthesis.model">
          {{ getModelIcon(synthesis.model) }} {{ synthesis.model }}
        </span>
        <span class="timestamp">üìÖ {{ formatDate(synthesis.created_at) }}</span>
      </div>

      <!-- Synthesis Information -->
      <div class="metadata">
        <h4 class="metadata-title">Synthesis Information</h4>
        <div class="metadata-item">
          <span class="label">Synthesis ID:</span>
          <span class="value">{{ synthesis.id }}</span>
        </div>
        <div class="metadata-item" *ngIf="synthesis.language">
          <span class="label">Language:</span>
          <span class="value">{{ synthesis.language | uppercase }}</span>
        </div>
        <div class="metadata-item">
          <span class="label">Model:</span>
          <span class="value">{{ synthesis.model }}</span>
        </div>
        <div class="metadata-item" *ngIf="synthesis.processing_time_seconds">
          <span class="label">Processing Time:</span>
          <span class="value">{{ synthesis.processing_time_seconds | number:'1.2-2' }}s</span>
        </div>
        <div class="metadata-item" *ngIf="synthesis.completed_at">
          <span class="label">Completed At:</span>
          <span class="value">{{ formatDate(synthesis.completed_at) }}</span>
        </div>
      </div>

      <!-- Audio Information -->
      <div class="metadata metadata-divider" *ngIf="synthesis.status === 'completed'">
        <h4 class="metadata-title">Audio Information</h4>
        <div class="metadata-item" *ngIf="synthesis.output_duration_seconds">
          <span class="label">Duration:</span>
          <span class="value">{{ formatDuration(synthesis.output_duration_seconds) }}</span>
        </div>
        <div class="metadata-item">
          <span class="label">Text Length:</span>
          <span class="value">{{ synthesis.text_length }} characters</span>
        </div>
      </div>

      <!-- Parameters -->
      <div class="metadata metadata-divider">
        <h4 class="metadata-title">Synthesis Parameters</h4>
        <div class="metadata-item">
          <span class="label">CFG Weight:</span>
          <span class="value">{{ synthesis.cfg_weight }}</span>
        </div>
        <div class="metadata-item">
          <span class="label">Exaggeration:</span>
          <span class="value">{{ synthesis.exaggeration }}</span>
        </div>
        <div class="metadata-item" *ngIf="synthesis.voice_reference_id">
          <span class="label">Voice Reference:</span>
          <span class="value">{{ synthesis.voice_reference_id }}</span>
        </div>
      </div>
    </div>

    <!-- Processing State -->
    <div class="processing-state" *ngIf="synthesis.status === 'processing' || synthesis.status === 'pending'">
      <div class="spinner"></div>
      <h3>Synthesis in progress...</h3>
      <p>Please wait while we generate your audio. This page will update automatically.</p>
    </div>

    <!-- Error State -->
    <div class="error-state" *ngIf="synthesis.status === 'failed'">
      <h3>‚ùå Synthesis Failed</h3>
      <p class="error-text">{{ synthesis.error_message }}</p>
    </div>

    <!-- Completed State - Text Result -->
    <div class="completed-state" *ngIf="synthesis.status === 'completed'">
      <div class="text-header">
        <h3>Input Text</h3>
        <div class="text-actions">
          <button
            class="btn btn-icon"
            (click)="playAudio()"
            [title]="isPlaying ? 'Stop audio' : 'Play audio'"
          >
            {{ isPlaying ? '‚èπÔ∏è Stop' : '‚ñ∂Ô∏è Play' }}
          </button>
          <button
            class="btn btn-icon"
            (click)="downloadAudio()"
            title="Download audio file"
          >
            ‚¨áÔ∏è Download
          </button>
          <button
            class="btn btn-icon"
            (click)="copyText()"
            title="Copy text to clipboard"
          >
            üìã Copy Text
          </button>
        </div>
      </div>

      <div class="text-content" [class.rtl]="isArabic(synthesis.input_text)">{{ synthesis.input_text }}</div>
      <div class="word-count">
        Word count: {{ getWordCount(synthesis.input_text) }} | Characters: {{ synthesis.input_text.length }}
      </div>
    </div>

    <!-- Delete Action -->
    <div class="delete-section">
      <button class="btn btn-danger" (click)="deleteSynthesis()">
        üóëÔ∏è Delete Synthesis
      </button>
    </div>
  </div>
</div>
