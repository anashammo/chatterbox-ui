<div class="history-container">
  <div class="header">
    <h1>Synthesis History</h1>
    <a routerLink="/" class="btn btn-primary">New Synthesis</a>
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="isLoading">
    <div class="spinner-large"></div>
    <p>Loading syntheses...</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && syntheses.length === 0">
    <h2>No syntheses yet</h2>
    <p>Create your first text-to-speech synthesis to get started.</p>
    <a routerLink="/" class="btn btn-primary">Create Synthesis</a>
  </div>

  <!-- Syntheses List -->
  <div class="syntheses-list" *ngIf="!isLoading && syntheses.length > 0">
    <div
      class="synthesis-card"
      *ngFor="let synthesis of syntheses"
      (click)="viewSynthesis(synthesis)"
    >
      <div class="card-header">
        <span class="status-badge" [ngClass]="getStatusClass(synthesis.status)">
          {{ synthesis.status }}
        </span>
        <span class="model-badge">{{ synthesis.model }}</span>
        <span class="date">{{ formatDate(synthesis.created_at) }}</span>
      </div>

      <div class="card-body">
        <p class="text-preview">{{ truncateText(synthesis.input_text) }}</p>

        <div class="card-meta" *ngIf="synthesis.status === 'completed'">
          <span class="duration" *ngIf="synthesis.output_duration_seconds">
            Duration: {{ synthesis.output_duration_seconds | number:'1.1-1' }}s
          </span>
          <span class="processing-time" *ngIf="synthesis.processing_time_seconds">
            Processed in {{ synthesis.processing_time_seconds | number:'1.2-2' }}s
          </span>
        </div>

        <div class="card-error" *ngIf="synthesis.status === 'failed'">
          {{ synthesis.error_message }}
        </div>
      </div>

      <div class="card-actions" *ngIf="synthesis.status === 'completed'">
        <button
          class="btn-icon"
          (click)="playAudio(synthesis, $event)"
          [title]="currentlyPlayingId === synthesis.id ? 'Stop' : 'Play'"
        >
          {{ currentlyPlayingId === synthesis.id ? 'â¹ï¸' : 'â–¶ï¸' }}
        </button>
        <button
          class="btn-icon"
          (click)="downloadAudio(synthesis, $event)"
          title="Download"
        >
          â¬‡ï¸
        </button>
        <button
          class="btn-icon btn-delete"
          (click)="deleteSynthesis(synthesis, $event)"
          title="Delete"
        >
          ğŸ—‘ï¸
        </button>
      </div>

      <div class="card-actions" *ngIf="synthesis.status !== 'completed'">
        <button
          class="btn-icon btn-delete"
          (click)="deleteSynthesis(synthesis, $event)"
          title="Delete"
        >
          ğŸ—‘ï¸
        </button>
      </div>
    </div>
  </div>
</div>
