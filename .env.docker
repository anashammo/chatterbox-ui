# ============================================================================
# Chatterbox TTS API - Docker Environment Configuration
# ============================================================================
# Copy this file to .env and configure as needed for Docker deployment
#
# NOTE: This configuration is for Docker deployment specifically
# For local development without Docker, use .env.example
#
# ============================================================================
# IMPORTANT: Port allocation for coexistence with other projects
# ============================================================================
# - Backend: Port 8002 (different from Whisper ASR on 8001)
# - Frontend: Port 4201 (different from Whisper ASR on 4200)
# - PostgreSQL: Port 5433 external (different from other projects on 5432)
# ============================================================================

# ============================================================================
# PostgreSQL Database Configuration (Production)
# ============================================================================
POSTGRES_USER=chatterbox
POSTGRES_PASSWORD=change_this_secure_password_in_production
POSTGRES_DB=chatterbox_tts
POSTGRES_PORT=5433

# Database connection URL (automatically constructed from above)
# For PostgreSQL (production): Automatically set in docker-compose.yml
# DATABASE_URL=postgresql://chatterbox:password@postgres:5432/chatterbox_tts

# ============================================================================
# Application Settings
# ============================================================================
APP_NAME="Chatterbox TTS API"
APP_VERSION=1.0.0

# Debug mode (provides detailed error messages)
# WARNING: Only use in development, not in production
DEBUG=false

# ============================================================================
# API Server Configuration
# ============================================================================
# Host to bind (use 0.0.0.0 for Docker)
API_HOST=0.0.0.0

# API Port (internal container port, mapped in docker-compose.yml)
API_PORT=8002

# External port mapping (configured in docker-compose.yml)
BACKEND_PORT=8002
FRONTEND_PORT=4201

# ============================================================================
# Chatterbox TTS Model Configuration
# ============================================================================
# Default TTS model for synthesis
# Options: turbo (350M), standard (500M), multilingual (500M)
# turbo: Fastest, single-step generation
# standard: Best quality, cfg/exaggeration tuning
# multilingual: 23+ languages, zero-shot voice cloning
TTS_DEFAULT_MODEL=turbo

# Device for TTS (cuda for GPU, cpu for CPU-only)
# Docker: cuda (requires nvidia-docker runtime)
TTS_DEVICE=cuda

# Default CFG weight for accent/style transfer (0.0-1.0)
TTS_DEFAULT_CFG_WEIGHT=0.5

# Default exaggeration/expressiveness (0.0-1.0+)
TTS_DEFAULT_EXAGGERATION=0.5

# Maximum text length for synthesis (in characters)
TTS_MAX_TEXT_LENGTH=5000

# ============================================================================
# File Storage Settings
# ============================================================================
# Directory for synthesized audio output files (inside container, mapped to volume)
AUDIO_OUTPUT_DIR=/app/audio_outputs

# Directory for voice reference files (inside container, mapped to volume)
VOICE_REFERENCE_DIR=/app/voice_references

# Maximum voice reference file size (in MB)
MAX_VOICE_REFERENCE_SIZE_MB=10

# Voice reference duration limits (in seconds)
# Chatterbox recommends ~10 seconds for optimal voice cloning
MIN_VOICE_REFERENCE_DURATION_SECONDS=5
MAX_VOICE_REFERENCE_DURATION_SECONDS=30

# ============================================================================
# CORS Configuration
# ============================================================================
# Allowed origins for CORS
# For Docker: Include both internal (container) and external (host) URLs
CORS_ORIGINS='["http://localhost","http://localhost:4201","http://frontend","*"]'

# ============================================================================
# Logging
# ============================================================================
LOG_LEVEL=INFO

# ============================================================================
# Docker-Specific Notes
# ============================================================================
#
# 1. Database:
#    - Production: Uses PostgreSQL (configured above)
#    - Port 5433 external to avoid conflicts with other PostgreSQL instances
#
# 2. Model Caching:
#    - Models are cached in a Docker volume (chatterbox-model-cache)
#    - Persists across container restarts and rebuilds
#    - First run will download models (may take time)
#    - Chatterbox models: ~350MB (turbo), ~500MB (standard/multilingual)
#
# 3. GPU Access:
#    - Requires nvidia-docker runtime installed on host
#    - GPU must be visible to Docker: docker run --gpus all
#    - RTX 5090 requires CUDA 12.8+ (Blackwell architecture, sm_120)
#
# 4. Networking:
#    - Frontend and backend communicate via Docker network
#    - API URL in frontend: http://backend:8002/api/v1 (internal)
#    - External access: http://localhost:4201 (frontend), http://localhost:8002 (backend)
#
# 5. Volumes:
#    - chatterbox-postgres-data: PostgreSQL database files
#    - chatterbox-audio-outputs: Synthesized audio files
#    - chatterbox-voice-references: Voice reference files for cloning
#    - chatterbox-model-cache: Chatterbox model files (~/.cache/huggingface)
#
# 6. Voice Cloning:
#    - Upload reference audio (5-30 seconds, ~10s recommended)
#    - Supports MP3, WAV, M4A, FLAC, OGG, WEBM
#    - Files stored in chatterbox-voice-references volume
#
# ============================================================================
